<!doctype html><html lang=zh><head><title>LINUX上统计网络接口数据包</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.fb9df7e952c9dccf496d00faec07de633aae460f909bbba4b5e0ad22f5887d73.css integrity="sha256-+5336VLJ3M9JbQD67AfeYzquRg+Qm7ukteCtIvWIfXM="><link rel=icon type=image/png href=/images/site/favicon_hu3d2f89ed4395f8e4a11f46415bebb510_10034_42x0_resize_box_3.png><meta property="og:url" content="/zh/posts/linux/network-packets/"><meta property="og:site_name" content="Mengz's Space ..."><meta property="og:title" content="LINUX上统计网络接口数据包"><meta property="og:description" content="在Linux系统上，我们可以通过 ip , netstat 或者 [ethtool] 命令显示网络接口丢弃数据包的统计信息。接下来我们看看如何使用每个命令。
使用netstat按接口显示数据包 其实 netstat 命令已经过时，可使用命令 ip 和 ss 来代替。但是 netstat 依然在一些旧的Linux分发版本上可用，因此在 ip/ss 不可用的情况，我们可以使用netstat，其语法如下
netstat -i netstat --interfaces 例如
~$ netstat -i Kernel Interface table Iface MTU Met RX-OK RX-ERR RX-DRP RX-OVR TX-OK TX-ERR TX-DRP TX-OVR Flg docker0 1500 0 188180 0 0 0 151852 0 0 0 BMRU eth0 1500 0 472368 0 0 0 375351 0 0 0 BMRU lo 65536 0 51687 0 0 0 51687 0 0 0 LRU vethc8f46ea 1500 0 136984 0 0 0 79587 0 0 0 BMRU 如果想显示每种协议的概要统计信息，可以执行"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-12-02T15:15:03+08:00"><meta property="article:modified_time" content="2020-12-02T15:15:03+08:00"><meta property="article:tag" content="Network"><meta property="article:tag" content="Linux"><meta name=description content="LINUX上统计网络接口数据包"><script src=https://cdn.counter.dev/script.js data-id=2905461c-37df-49f9-a4ca-0ea1ba64543a data-utcoffset=1></script></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/zh/><img src=/images/site/main-logo_hu69a4da50b288ac7c5f97b1e1012a418e_8650_42x0_resize_box_3.png alt=Logo>
Mengz's Space ...</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu69a4da50b288ac7c5f97b1e1012a418e_8650_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu3d2f89ed4395f8e4a11f46415bebb510_10034_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/zh/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/zh/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/k8s/>Kubernetes</a><ul><li><a href=/zh/posts/k8s/health-checks/ title=K8S健康检查最佳实践>K8S健康检查最佳实践</a></li><li><a href=/zh/posts/k8s/kubectl-plugins/ title=扩展你的KUBECTL功能>扩展你的KUBECTL功能</a></li><li><a href=/zh/posts/k8s/lightweight-k3s/ title=轻量级Kubernetes集群-K3S>轻量级Kubernetes集群-K3S</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/zh/posts/linux/>LINUX</a><ul class=active><li><a href=/zh/posts/linux/bumlebee-nvidia/ title=BUMBLEBEE禁用NVIDIA显卡>BUMBLEBEE禁用NVIDIA显卡</a></li><li><a href=/zh/posts/linux/systemd-hostnamectl/ title=HOSTNAMECTL管理主机名>HOSTNAMECTL管理主机名</a></li><li><a href=/zh/posts/linux/make-undeletable/ title=LINUX上创建不可删除文件>LINUX上创建不可删除文件</a></li><li><a class=active href=/zh/posts/linux/network-packets/ title=LINUX上统计网络接口数据包>LINUX上统计网络接口数据包</a></li><li><a href=/zh/posts/linux/opensuse-zypper/ title=OPENSUSE上的ZYPPER包管理器>OPENSUSE上的ZYPPER包管理器</a></li><li><a href=/zh/posts/linux/opensuse-cronjob/ title=OPENSUSE上的定时任务>OPENSUSE上的定时任务</a></li><li><a href=/zh/posts/linux/systemd-systemctl/ title=SYSTEMCTL管理系统服务>SYSTEMCTL管理系统服务</a></li><li><a href=/zh/posts/linux/systemd-timer/ title=SYSTEMD定时服务>SYSTEMD定时服务</a></li><li><a href=/zh/posts/linux/opensuse-upgrade/ title="升级OPENSUSE LEAP">升级OPENSUSE LEAP</a></li><li><a href=/zh/posts/linux/wireguard-vpn/ title=在LINUX上配置WIREGUARD>在LINUX上配置WIREGUARD</a></li><li><a href=/zh/posts/linux/ubuntu-old-kernel/ title=在UBUNTU上删除旧的内核>在UBUNTU上删除旧的内核</a></li><li><a href=/zh/posts/linux/what-hardware/ title=查看硬件信息>查看硬件信息</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/windows/>Windows</a><ul><li><a href=/zh/posts/windows/windows10-wsl2/ title=Windows10上安装WSL2>Windows10上安装WSL2</a></li><li><a href=/zh/posts/windows/windows10-virtio-image/ title=加载virtio驱动的Windows10安装镜像>加载virtio驱动的Windows10安装镜像</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/container-tech/>容器技术</a><ul><li><a href=/zh/posts/container-tech/docker-live-restore/ title="DOCKER LIVERESTORE特性">DOCKER LIVERESTORE特性</a></li><li><a href=/zh/posts/container-tech/docker-sbom/ title="DOCKER SBOM镜像物料清单">DOCKER SBOM镜像物料清单</a></li><li><a href=/zh/posts/container-tech/dockerfile-best/ title=DOCKERFILE构建最佳实践>DOCKERFILE构建最佳实践</a></li><li><a href=/zh/posts/container-tech/docker-intro/ title=DOCKER入门>DOCKER入门</a></li><li><a href=/zh/posts/container-tech/mariadb-docker/ title=DOCKER构建MariaDB>DOCKER构建MariaDB</a></li><li><a href=/zh/posts/container-tech/docker-container-app/ title=DOCKER构建容器化应用>DOCKER构建容器化应用</a></li><li><a href=/zh/posts/container-tech/docker-wechat/ title=DOCKER运行微信桌面客户端>DOCKER运行微信桌面客户端</a></li><li><a href=/zh/posts/container-tech/docker-desktop-windows/ title="WINDOWS上的DOCKER DESKTOP">WINDOWS上的DOCKER DESKTOP</a></li><li><a href=/zh/posts/container-tech/docker-compose-v2/ title="开始使用DOCKER COMPOSE V2">开始使用DOCKER COMPOSE V2</a></li><li><a href=/zh/posts/container-tech/smallest-web-container/ title=最小化静态WEB容器实践>最小化静态WEB容器实践</a></li><li><a href=/zh/posts/container-tech/docker-mqtt-broker/ title=本地环境运行MQTT容器>本地环境运行MQTT容器</a></li><li><a href=/zh/posts/container-tech/docker-context-remote/ title=管理远程DOCKER主机>管理远程DOCKER主机</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/devops/>开发运维</a><ul><li><a href=/zh/posts/devops/github-actions/ title="GITHUB ACTIONS工作流">GITHUB ACTIONS工作流</a></li><li><a href=/zh/posts/devops/gitlab-ci-docker/ title="GITLAB CI自动部署容器应用">GITLAB CI自动部署容器应用</a></li><li><a href=/zh/posts/devops/k3s-terraform-ansible/ title=IaC示例-TERRAFORM&amp;ANSIBLE创建K3S集群>IaC示例-TERRAFORM&amp;ANSIBLE创建K3S集群</a></li><li><a href=/zh/posts/devops/tf-rover/ title=TF执行计划可视化>TF执行计划可视化</a></li><li><a href=/zh/posts/devops/tf-aws-lightsail/ title="TF管理AWS LIGHTSAIL实例">TF管理AWS LIGHTSAIL实例</a></li><li><a href=/zh/posts/devops/single-application-cicd/ title=一体化CI/CD平台>一体化CI/CD平台</a></li><li><a href=/zh/posts/devops/open-gitops/ title="解读OPEN GITOPS 1.0">解读OPEN GITOPS 1.0</a></li><li><a href=/zh/posts/devops/tf-cloud/ title="迁移本地项目到TF CLOUD">迁移本地项目到TF CLOUD</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/opentool/>开源工具</a><ul><li><a href=/zh/posts/opentool/diun-intro/ title=DIUN-容器镜像更新通知>DIUN-容器镜像更新通知</a></li><li><a href=/zh/posts/opentool/rclone-sync/ title=RCLOUD与云存储同步>RCLOUD与云存储同步</a></li><li><a href=/zh/posts/opentool/find-files/ title=文件系统查找工具>文件系统查找工具</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/programming/>编程</a><ul><li><a href=/zh/posts/programming/cocktail-improve/ title=改良鸡尾酒排序算法>改良鸡尾酒排序算法</a></li><li><a href=/zh/posts/programming/shell-debug/ title=调试Shell脚本错误>调试Shell脚本错误</a></li></ul></li><li><a href=/zh/posts/markdown-sample/ title=Markdown示例>Markdown示例</a></li><li><a href=/zh/posts/shortcodes/ title=短代码示例>短代码示例</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/mengzyou_huc2c98b30dea57d312a21b09cfacc124e_6244_120x120_fit_q75_h2_box_2.webp alt="Author Image"><h5 class=author-name>You Mengzhe</h5><p>2020年12月2日星期三</p></div><div class=title><h1>LINUX上统计网络接口数据包</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/zh/tags/network/ class="btn, btn-sm">network</a></li><li class=rounded><a href=/zh/tags/linux/ class="btn, btn-sm">linux</a></li></ul></div><div class=post-content id=post-content><p>在Linux系统上，我们可以通过 <a href=https://linux.die.net/man/8/ip target=_blank rel=noopener>ip</a> , <a href=https://linux.die.net/man/8/netstat target=_blank rel=noopener>netstat</a> 或者 [ethtool] 命令显示网络接口丢弃数据包的统计信息。接下来我们看看如何使用每个命令。</p><h2 id=使用netstat按接口显示数据包>使用netstat按接口显示数据包</h2><p>其实 <a href=https://linux.die.net/man/8/netstat target=_blank rel=noopener>netstat</a> 命令已经过时，可使用命令 <a href=https://linux.die.net/man/8/ip target=_blank rel=noopener>ip</a> 和 <a href=https://man7.org/linux/man-pages/man8/ss.8.html target=_blank rel=noopener>ss</a> 来代替。但是 <a href=https://linux.die.net/man/8/netstat target=_blank rel=noopener>netstat</a> 依然在一些旧的Linux分发版本上可用，因此在 ip/ss 不可用的情况，我们可以使用netstat，其语法如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>netstat -i
</span></span><span style=display:flex><span>netstat --interfaces
</span></span></code></pre></div><p>例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>~$ netstat -i
</span></span><span style=display:flex><span>Kernel Interface table
</span></span><span style=display:flex><span>Iface   MTU Met   RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg
</span></span><span style=display:flex><span>docker0    <span style=color:#ae81ff>1500</span> <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>188180</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>151852</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> BMRU
</span></span><span style=display:flex><span>eth0       <span style=color:#ae81ff>1500</span> <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>472368</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>375351</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> BMRU
</span></span><span style=display:flex><span>lo        <span style=color:#ae81ff>65536</span> <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>51687</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>51687</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> LRU
</span></span><span style=display:flex><span>vethc8f46ea  <span style=color:#ae81ff>1500</span> <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>136984</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>79587</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> BMRU
</span></span></code></pre></div><p>如果想显示每种协议的概要统计信息，可以执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>netstat -s
</span></span><span style=display:flex><span>netstat --statistics
</span></span></code></pre></div><p>例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ netstat -s
</span></span><span style=display:flex><span>Ip:
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>527622</span> total packets received
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>19</span> with invalid addresses
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>329762</span> forwarded
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span> incoming packets discarded
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>191137</span> incoming packets delivered
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>568337</span> requests sent out
</span></span><span style=display:flex><span>Icmp:
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>8</span> ICMP messages received
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>8</span> input ICMP message failed.
</span></span><span style=display:flex><span>    ICMP input histogram:
</span></span><span style=display:flex><span>        destination unreachable: <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span>        timeout in transit: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>5</span> ICMP messages sent
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span> ICMP messages failed
</span></span><span style=display:flex><span>    ICMP output histogram:
</span></span><span style=display:flex><span>        destination unreachable: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>IcmpMsg:
</span></span><span style=display:flex><span>        InType3: <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span>        InType11: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        OutType3: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>Tcp:
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>2509</span> active connections openings
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>26</span> passive connection openings
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>748</span> failed connection attempts
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>14</span> connection resets received
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>4</span> connections established
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>182968</span> segments received
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>241886</span> segments send out
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>72</span> segments retransmited
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>279</span> bad segments received.
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>1844</span> resets sent
</span></span><span style=display:flex><span>    InCsumErrors: <span style=color:#ae81ff>279</span>
</span></span><span style=display:flex><span>Udp:
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>8067</span> packets received
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>5</span> packets to unknown port received.
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span> packet receive errors
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>11440</span> packets sent
</span></span></code></pre></div><p>只显示tcp的信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>netstat -s -t
</span></span><span style=display:flex><span>netstat --statistics --tcp
</span></span></code></pre></div><p>只显示udp的信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>netstat -s -u
</span></span><span style=display:flex><span>netstat --statistics --udp
</span></span></code></pre></div><h2 id=使用ip命令显示网络接口数据包信息>使用ip命令显示网络接口数据包信息</h2><p>如果要显示所有接口的统计信息，命令如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ip -s link
</span></span></code></pre></div><p>如果要显示某一个接口的，则制定接口名</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ip -s link show <span style=color:#f92672>{</span>interface<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ip -s link show eth0
</span></span><span style=display:flex><span>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style=color:#ae81ff>1500</span> qdisc pfifo_fast state UP mode DEFAULT group default qlen <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>    link/ether 00:16:3e:02:c8:e3 brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>    RX: bytes  packets  errors  dropped overrun mcast   
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>377786943</span>  <span style=color:#ae81ff>473945</span>   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>       
</span></span><span style=display:flex><span>    TX: bytes  packets  errors  dropped carrier collsns 
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>266024587</span>  <span style=color:#ae81ff>377467</span>   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>RX指示了接收的数据包，TX指示了发送的数据包。</p><h2 id=使用ethtool命令查询指定网络接口的信息>使用ethtool命令查询指定网络接口的信息</h2><p>可以使用 -S 或者 &ndash;statistics 选项来显示统计信息，语法如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ethtool -S <span style=color:#f92672>{</span>device<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ ethtool -S wlan1
</span></span><span style=display:flex><span>NIC statistics:
</span></span><span style=display:flex><span>     rx_packets: <span style=color:#ae81ff>487703</span>
</span></span><span style=display:flex><span>     rx_bytes: <span style=color:#ae81ff>207474712</span>
</span></span><span style=display:flex><span>     rx_duplicates: <span style=color:#ae81ff>180</span>
</span></span><span style=display:flex><span>     rx_fragments: <span style=color:#ae81ff>487682</span>
</span></span><span style=display:flex><span>     rx_dropped: <span style=color:#ae81ff>19952</span>
</span></span><span style=display:flex><span>     tx_packets: <span style=color:#ae81ff>141579</span>
</span></span><span style=display:flex><span>     tx_bytes: <span style=color:#ae81ff>34804215</span>
</span></span><span style=display:flex><span>     tx_filtered: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>     tx_retry_failed: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>     tx_retries: <span style=color:#ae81ff>19541</span>
</span></span><span style=display:flex><span>     sta_state: <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>     txrate: <span style=color:#ae81ff>400000000</span>
</span></span><span style=display:flex><span>     rxrate: <span style=color:#ae81ff>360000000</span>
</span></span><span style=display:flex><span>     signal: <span style=color:#ae81ff>201</span>
</span></span><span style=display:flex><span>     channel: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>     noise: <span style=color:#ae81ff>18446744073709551615</span>
</span></span><span style=display:flex><span>     ch_time: <span style=color:#ae81ff>18446744073709551615</span>
</span></span><span style=display:flex><span>     ch_time_busy: <span style=color:#ae81ff>18446744073709551615</span>
</span></span><span style=display:flex><span>     ch_time_ext_busy: <span style=color:#ae81ff>18446744073709551615</span>
</span></span><span style=display:flex><span>     ch_time_rx: <span style=color:#ae81ff>18446744073709551615</span>
</span></span><span style=display:flex><span>     ch_time_tx: <span style=color:#ae81ff>18446744073709551615</span>
</span></span></code></pre></div><p>还可以直接使用cat或者column命令来查询 <em>/proc/net/dev</em> 文件，例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ column -t /proc/net/dev
</span></span><span style=display:flex><span>Inter-|           Receive     |        Transmit                                                                                                              
</span></span><span style=display:flex><span>face              |bytes      packets  errs      drop  fifo  frame  compressed  multicast|bytes  packets    errs     drop  fifo  colls  carrier  compressed  
</span></span><span style=display:flex><span>lo:               <span style=color:#ae81ff>230352757</span>   <span style=color:#ae81ff>1201722</span>  <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>230352757</span>  <span style=color:#ae81ff>1201722</span>  <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>eth0:             <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>0</span>          <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>wlan1:            <span style=color:#ae81ff>1346770664</span>  <span style=color:#ae81ff>2865963</span>  <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>14</span>    <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>282983658</span>  <span style=color:#ae81ff>1154942</span>  <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>br-13cb4d22d1c8:  <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>0</span>          <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>br-44561b4ee062:  <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>0</span>          <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>br-70b0dad49865:  <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>0</span>          <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>docker0:          <span style=color:#ae81ff>6824830</span>     <span style=color:#ae81ff>44848</span>    <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>133304965</span>  <span style=color:#ae81ff>47104</span>    <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>vetheb8b528:      <span style=color:#ae81ff>2360070</span>     <span style=color:#ae81ff>13321</span>    <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>60431688</span>   <span style=color:#ae81ff>18817</span>    <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>vetha4dc663:      <span style=color:#ae81ff>461283</span>      <span style=color:#ae81ff>2464</span>     <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>2981558</span>    <span style=color:#ae81ff>2302</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h2 id=补充如何诊断数据包丢弃的原因>补充：如何诊断数据包丢弃的原因</h2><p>发现网络数据有被丢弃的请，想找出原因，这里介绍一个工具 <a href=https://github.com/nhorman/dropwatch target=_blank rel=noopener>dropwath</a>。</p><p>首先使用需要自己编译安装该工具，下面示例在Ubuntu上编译安装：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install libpcap-dev libnl-3-dev libnl-genl-3-dev binutils-dev libreadline6-dev autoconf libtool pkg-config build-essential
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>git clone https://github.com/nhorman/dropwatch.git
</span></span><span style=display:flex><span>cd dropwatch
</span></span><span style=display:flex><span>./autogen.sh
</span></span><span style=display:flex><span>./configure
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>make install
</span></span></code></pre></div><p>然后可以运行dropwatch进行监控</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ dropwatch -l kas
</span></span><span style=display:flex><span>Initializing kallsyms db
</span></span><span style=display:flex><span>dropwatch&gt; help
</span></span><span style=display:flex><span>Command Syntax:
</span></span><span style=display:flex><span>exit                             - Quit dropwatch
</span></span><span style=display:flex><span>help                             - Display this message
</span></span><span style=display:flex><span>set:
</span></span><span style=display:flex><span>        alertlimit &lt;number&gt;      - capture only this many alert packets
</span></span><span style=display:flex><span>        alertmode &lt;mode&gt;         - set mode to <span style=color:#e6db74>&#34;summary&#34;</span> or <span style=color:#e6db74>&#34;packet&#34;</span>
</span></span><span style=display:flex><span>        trunc &lt;len&gt;              - truncate packets to this length. Only applicable when <span style=color:#e6db74>&#34;alertmode&#34;</span> is set to <span style=color:#e6db74>&#34;packet&#34;</span>
</span></span><span style=display:flex><span>        queue &lt;len&gt;              - queue up to this many packets in the kernel. Only applicable when <span style=color:#e6db74>&#34;alertmode&#34;</span> is set to <span style=color:#e6db74>&#34;packet&#34;</span>
</span></span><span style=display:flex><span>        sw &lt;true | false&gt;        - monitor software drops
</span></span><span style=display:flex><span>        hw &lt;true | false&gt;        - monitor hardware drops
</span></span><span style=display:flex><span>start                            - start capture
</span></span><span style=display:flex><span>stop                             - stop capture
</span></span><span style=display:flex><span>show                             - show existing configuration
</span></span><span style=display:flex><span>stats                            - show statistics
</span></span><span style=display:flex><span>dropwatch&gt;
</span></span></code></pre></div><p>还可以通过 <a href=https://www.tcpdump.org/manpages/tcpdump.1.html target=_blank rel=noopener>tcpdump</a> 进行网络抓包，然后使用 <a href=https://www.wireshark.org/ target=_blank rel=noopener>wireshark</a> 来进行分析。</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=%2fzh%2fposts%2flinux%2fnetwork-packets%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=%2fzh%2fposts%2flinux%2fnetwork-packets%2f&text=LINUX%e4%b8%8a%e7%bb%9f%e8%ae%a1%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%8f%a3%e6%95%b0%e6%8d%ae%e5%8c%85&via=Mengz%27s%20Space%20..." target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=%2fzh%2fposts%2flinux%2fnetwork-packets%2f&title=LINUX%e4%b8%8a%e7%bb%9f%e8%ae%a1%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%8f%a3%e6%95%b0%e6%8d%ae%e5%8c%85" target=_blank><i class="fab fa-linkedin"></i></a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/zh/posts/linux/make-undeletable/ title=LINUX上创建不可删除文件 class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>LINUX上创建不可删除文件</div></a></div><div class="col-md-6 next-article"><a href=/zh/posts/linux/opensuse-zypper/ title=OPENSUSE上的ZYPPER包管理器 class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>OPENSUSE上的ZYPPER包管理器</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#使用netstat按接口显示数据包>使用netstat按接口显示数据包</a></li><li><a href=#使用ip命令显示网络接口数据包信息>使用ip命令显示网络接口数据包信息</a></li><li><a href=#使用ethtool命令查询指定网络接口的信息>使用ethtool命令查询指定网络接口的信息</a></li><li><a href=#补充如何诊断数据包丢弃的原因>补充：如何诊断数据包丢弃的原因</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/zh/#about>关于</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#skills>技能</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#experiences>工作经历</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#education>教育</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#recent-posts>近期文章</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#accomplishments>技能学习</a></li><li class=nav-item><a class=smooth-scroll href=https://live.mengz.dev/>LiveTerm</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:mengz.you@outlook.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>mengz.you@outlook.com</span></a></li><li><a href=https://github.com/mengzyou target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>mengzyou</span></a></li><li><a href=https://www.linkedin.com/in/mengzyou target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>You Mengzhe</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2024 - Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.74035eba644bbae33efea73e1508acb9c99d04231c848dda7fa8ce5dd16fff9e.js integrity="sha256-dANeumRLuuM+/qc+FQisucmdBCMchI3af6jOXdFv/54=" defer></script><script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script><script>kofiWidgetOverlay.draw("mengz",{type:"floating-chat","floating-chat.donateButton.text":"Buy me a book","floating-chat.donateButton.text-color":"#f9fafc","floating-chat.donateButton.background-color":"#248aaa"})</script></body></html>