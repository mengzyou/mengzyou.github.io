<!doctype html><html lang=zh><head><title>轻量级Kubernetes集群-K3S</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/application.fb9df7e952c9dccf496d00faec07de633aae460f909bbba4b5e0ad22f5887d73.css integrity="sha256-+5336VLJ3M9JbQD67AfeYzquRg+Qm7ukteCtIvWIfXM="><link rel=icon type=image/png href=/images/site/favicon_hu3d2f89ed4395f8e4a11f46415bebb510_10034_42x0_resize_box_3.png><meta property="og:title" content="轻量级Kubernetes集群-K3S"><meta property="og:description" content="介绍一款轻量级kubernetes集群工具k3s"><meta property="og:type" content="article"><meta property="og:url" content="/zh/posts/k8s/lightweight-k3s/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-22T21:00:13+08:00"><meta property="article:modified_time" content="2022-07-22T21:00:13+08:00"><meta name=description content="介绍一款轻量级kubernetes集群工具k3s"><script src=https://cdn.counter.dev/script.js data-id=2905461c-37df-49f9-a4ca-0ea1ba64543a data-utcoffset=1></script></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/zh/><img src=/images/site/main-logo_hu69a4da50b288ac7c5f97b1e1012a418e_8650_42x0_resize_box_3.png alt=Logo>
Mengz's Space ...</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu69a4da50b288ac7c5f97b1e1012a418e_8650_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu3d2f89ed4395f8e4a11f46415bebb510_10034_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/zh/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/zh/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/zh/posts/k8s/>Kubernetes</a><ul class=active><li><a href=/zh/posts/k8s/health-checks/ title=K8S健康检查最佳实践>K8S健康检查最佳实践</a></li><li><a href=/zh/posts/k8s/kubectl-plugins/ title=扩展你的KUBECTL功能>扩展你的KUBECTL功能</a></li><li><a class=active href=/zh/posts/k8s/lightweight-k3s/ title=轻量级Kubernetes集群-K3S>轻量级Kubernetes集群-K3S</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/linux/>LINUX</a><ul><li><a href=/zh/posts/linux/bumlebee-nvidia/ title=BUMBLEBEE禁用NVIDIA显卡>BUMBLEBEE禁用NVIDIA显卡</a></li><li><a href=/zh/posts/linux/systemd-hostnamectl/ title=HOSTNAMECTL管理主机名>HOSTNAMECTL管理主机名</a></li><li><a href=/zh/posts/linux/make-undeletable/ title=LINUX上创建不可删除文件>LINUX上创建不可删除文件</a></li><li><a href=/zh/posts/linux/network-packets/ title=LINUX上统计网络接口数据包>LINUX上统计网络接口数据包</a></li><li><a href=/zh/posts/linux/opensuse-zypper/ title=OPENSUSE上的ZYPPER包管理器>OPENSUSE上的ZYPPER包管理器</a></li><li><a href=/zh/posts/linux/opensuse-cronjob/ title=OPENSUSE上的定时任务>OPENSUSE上的定时任务</a></li><li><a href=/zh/posts/linux/systemd-systemctl/ title=SYSTEMCTL管理系统服务>SYSTEMCTL管理系统服务</a></li><li><a href=/zh/posts/linux/systemd-timer/ title=SYSTEMD定时服务>SYSTEMD定时服务</a></li><li><a href=/zh/posts/linux/opensuse-upgrade/ title="升级OPENSUSE LEAP">升级OPENSUSE LEAP</a></li><li><a href=/zh/posts/linux/wireguard-vpn/ title=在LINUX上配置WIREGUARD>在LINUX上配置WIREGUARD</a></li><li><a href=/zh/posts/linux/ubuntu-old-kernel/ title=在UBUNTU上删除旧的内核>在UBUNTU上删除旧的内核</a></li><li><a href=/zh/posts/linux/what-hardware/ title=查看硬件信息>查看硬件信息</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/windows/>Windows</a><ul><li><a href=/zh/posts/windows/windows10-wsl2/ title=Windows10上安装WSL2>Windows10上安装WSL2</a></li><li><a href=/zh/posts/windows/windows10-virtio-image/ title=加载virtio驱动的Windows10安装镜像>加载virtio驱动的Windows10安装镜像</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/container-tech/>容器技术</a><ul><li><a href=/zh/posts/container-tech/docker-live-restore/ title="DOCKER LIVERESTORE特性">DOCKER LIVERESTORE特性</a></li><li><a href=/zh/posts/container-tech/docker-sbom/ title="DOCKER SBOM镜像物料清单">DOCKER SBOM镜像物料清单</a></li><li><a href=/zh/posts/container-tech/dockerfile-best/ title=DOCKERFILE构建最佳实践>DOCKERFILE构建最佳实践</a></li><li><a href=/zh/posts/container-tech/docker-intro/ title=DOCKER入门>DOCKER入门</a></li><li><a href=/zh/posts/container-tech/mariadb-docker/ title=DOCKER构建MariaDB>DOCKER构建MariaDB</a></li><li><a href=/zh/posts/container-tech/docker-container-app/ title=DOCKER构建容器化应用>DOCKER构建容器化应用</a></li><li><a href=/zh/posts/container-tech/docker-wechat/ title=DOCKER运行微信桌面客户端>DOCKER运行微信桌面客户端</a></li><li><a href=/zh/posts/container-tech/docker-desktop-windows/ title="WINDOWS上的DOCKER DESKTOP">WINDOWS上的DOCKER DESKTOP</a></li><li><a href=/zh/posts/container-tech/docker-compose-v2/ title="开始使用DOCKER COMPOSE V2">开始使用DOCKER COMPOSE V2</a></li><li><a href=/zh/posts/container-tech/smallest-web-container/ title=最小化静态WEB容器实践>最小化静态WEB容器实践</a></li><li><a href=/zh/posts/container-tech/docker-mqtt-broker/ title=本地环境运行MQTT容器>本地环境运行MQTT容器</a></li><li><a href=/zh/posts/container-tech/docker-context-remote/ title=管理远程DOCKER主机>管理远程DOCKER主机</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/devops/>开发运维</a><ul><li><a href=/zh/posts/devops/github-actions/ title="GITHUB ACTIONS工作流">GITHUB ACTIONS工作流</a></li><li><a href=/zh/posts/devops/gitlab-ci-docker/ title="GITLAB CI自动部署容器应用">GITLAB CI自动部署容器应用</a></li><li><a href=/zh/posts/devops/k3s-terraform-ansible/ title=IaC示例-TERRAFORM&amp;ANSIBLE创建K3S集群>IaC示例-TERRAFORM&amp;ANSIBLE创建K3S集群</a></li><li><a href=/zh/posts/devops/tf-rover/ title=TF执行计划可视化>TF执行计划可视化</a></li><li><a href=/zh/posts/devops/tf-aws-lightsail/ title="TF管理AWS LIGHTSAIL实例">TF管理AWS LIGHTSAIL实例</a></li><li><a href=/zh/posts/devops/single-application-cicd/ title=一体化CI/CD平台>一体化CI/CD平台</a></li><li><a href=/zh/posts/devops/open-gitops/ title="解读OPEN GITOPS 1.0">解读OPEN GITOPS 1.0</a></li><li><a href=/zh/posts/devops/tf-cloud/ title="迁移本地项目到TF CLOUD">迁移本地项目到TF CLOUD</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/opentool/>开源工具</a><ul><li><a href=/zh/posts/opentool/diun-intro/ title=DIUN-容器镜像更新通知>DIUN-容器镜像更新通知</a></li><li><a href=/zh/posts/opentool/rclone-sync/ title=RCLOUD与云存储同步>RCLOUD与云存储同步</a></li><li><a href=/zh/posts/opentool/find-files/ title=文件系统查找工具>文件系统查找工具</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/programming/>编程</a><ul><li><a href=/zh/posts/programming/cocktail-improve/ title=改良鸡尾酒排序算法>改良鸡尾酒排序算法</a></li><li><a href=/zh/posts/programming/shell-debug/ title=调试Shell脚本错误>调试Shell脚本错误</a></li></ul></li><li><a href=/zh/posts/markdown-sample/ title=Markdown示例>Markdown示例</a></li><li><a href=/zh/posts/shortcodes/ title=短代码示例>短代码示例</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/zh/posts/k8s/lightweight-k3s/k3s-kubernetes.webp)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/mengzyou_huc2c98b30dea57d312a21b09cfacc124e_6244_120x120_fit_q75_h2_box_2.webp alt="Author Image"><h5 class=author-name>You Mengzhe</h5><p>2022年7月22日星期五</p></div><div class=title><h1>轻量级Kubernetes集群-K3S</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/zh/tags/contianer/ class="btn, btn-sm">contianer</a></li><li class=rounded><a href=/zh/tags/kubernetes/ class="btn, btn-sm">kubernetes</a></li><li class=rounded><a href=/zh/tags/cluster/ class="btn, btn-sm">cluster</a></li></ul></div><div class=post-content id=post-content><p><a href=https://k3s.io target=_blank rel=noopener>K3S</a> 是 <a href=https://rancher.com target=_blank rel=noopener>Rancher</a> 为物联网（IoT）和边缘计算环境开发的轻量级 <a href=https://kubernetes.io target=_blank rel=noopener>Kubernetes</a> 发行版本。相比原生的 Kubernetes，其移除了很多非必要的组件，例如云控制管理器（CCM）、内置的（In-Tree）的存储插件等，以及为ARM架构的基础设施做了优化。</p><p>K3s 的轻量级同时也体现在其打包成一个二进制可执行文件进行分发，状态存储除了支持 etcd 外，还支持 Sqlite3、MySQl和Postgres。其跟多特性可参考<a href=https://rancher.com/docs/k3s/latest/en/ target=_blank rel=noopener>官方文档</a>。</p><p>K3s 支持单节集群部署（可用于开发测试环境），也支持高可用的多节点集群。同时还可以通过 <a href=https://k3d.io target=_blank rel=noopener>k3d</a> 项目快速在本地开发环境使用Docker容器部署 k3s 集群作为开发环境。</p><p>这里我将演示通过虚拟机部署一个高可用的多节点集群（3个Servers节点 + 3个Agent节点）。</p><h2 id=k3s架构>k3S架构</h2><p><img src=https://k3s.io/img/how-it-works-k3s-revised.svg alt=k3s-arch></p><p>上图是来自k3s官网的架构图，其架构与Kubernetes的架构是相似的，k3s的server节点也就是控制面节点，agent节点是工作负载节点。k3s默认使用 <a href=https://containerd.io/ target=_blank rel=noopener>containerd</a> 作为容器运行时。</p><p>更信息的部署架构可参考<a href=https://rancher.com/docs/k3s/latest/en/architecture/ target=_blank rel=noopener>官方文档</a>。</p><h2 id=准备虚拟机节点>准备虚拟机节点</h2><p>这里我们将部署 3 + 3 的集群，需要6台虚拟机，基本配置如下</p><table><thead><tr><th>主机名</th><th>IP</th><th>vCPU</th><th>内存</th></tr></thead><tbody><tr><td>homek3s-server1</td><td>192.168.0.150</td><td>1</td><td>2 GB</td></tr><tr><td>homek3s-server2</td><td>192.168.0.151</td><td>1</td><td>2 GB</td></tr><tr><td>homek3s-server3</td><td>192.168.0.152</td><td>1</td><td>2 GB</td></tr><tr><td>homek3s-agent1</td><td>192.168.0.154</td><td>2</td><td>4 GB</td></tr><tr><td>homek3s-agent2</td><td>192.168.0.155</td><td>2</td><td>4 GB</td></tr><tr><td>homek3s-agent3</td><td>192.168.0.156</td><td>2</td><td>4 GB</td></tr></tbody></table><p>部署的最小需求，可参考<a href=https://rancher.com/docs/k3s/latest/en/installation/installation-requirements/ target=_blank rel=noopener>官方文档</a>。</p><p>K3s 支持大部分主流的Linux操作系统，这里我使用的是 <a href=https://microos.opensuse.org/ target=_blank rel=noopener>openSUSE Leap Micro 15.2</a>，其是一个基于openSUSE，为容器负载而设计的操作系统。</p><p>为了部署简单，这里我们禁用了系统的防火墙，如果开启防火墙，需要为Server节点开放如下端口</p><ul><li>6443/TCP - Kubernetes API 服务</li><li>8472/UDP - Flannel VXLAN模式需要</li><li>51820/UDP - Flannel Wireguard后端需要</li><li>10250/TCP - Kubelet metrics需要</li><li>2379-2380/TCP - 基于内嵌etcd高可用部署模式需要</li></ul><h2 id=启动server节点>启动Server节点</h2><p>首先登陆到第一个Server节点 <strong>homek3s-server1</strong>，然后下载最新版本（v1.24.3+k3s1）的 k3s 二进制文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># curl -sfL https://github.com/k3s-io/k3s/releases/download/v1.24.3%2Bk3s1/k3s -o /usr/local/bin/k3s</span>
</span></span><span style=display:flex><span><span style=color:#75715e># chmod +x k3s</span>
</span></span><span style=display:flex><span><span style=color:#75715e># k3s --version</span>
</span></span><span style=display:flex><span>k3s version v1.24.3+k3s1 <span style=color:#f92672>(</span>990ba0e8<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>go version go1.18.1
</span></span></code></pre></div><p>k3s 支持一下几个子命令</p><ul><li>k3s server - 用于运行管理服务节点</li><li>k3s agent - 用于运行agent工作节点</li><li>k3s kubectl - 运行 kubectl 命令</li><li>k3s crictl - 运行 crictl 容器管理命令</li></ul><p>其他的命令帮助，请通过 <code>k3s --help</code> 查看。</p><p>这里我们将要创建一个使用内置etcd数据库的高可用集群，执行如下命令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># k3s server --cluster-init --advertise-address=192.168.0.150 --tls-san=homek3s.mengz.lan --write-kubeconfig-mode=644</span>
</span></span></code></pre></div><p>参数 &ndash;cluster-init 是使用内置的etcd初始户一个新的集群;<br>参数 &ndash;advertise-address 是指定API服务器的监听IP地址，如果不指定，默认为节点的IP地址;<br>参数 &ndash;tls-san 是指定额外的域名或者IP地址作为TLS证书的SAN，使得我们从客户端可通过域名访问而API服务器。</p><p>运行成功后，在 <strong>homek3s-server1</strong> 打开另一个终端执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># k3s kubectl get no</span>
</span></span><span style=display:flex><span>NAME              STATUS   ROLES                       AGE   VERSION
</span></span><span style=display:flex><span>homek3s-server1   Ready    control-plane,etcd,master   27h   v1.24.3+k3s1
</span></span></code></pre></div><p>可以看到，集群中以及运行了一个节点，不过这时k3s服务是启动在前台的，我们需要配置一个 systemd 服务，让其以服务形式运行。<br>创建文件 <em>/etc/systemd/system/k3s.service</em>，内如如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-service data-lang=service><span style=display:flex><span><span style=color:#66d9ef>[Unit]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Description</span><span style=color:#f92672>=</span><span style=color:#e6db74>Lightweight Kubernetes</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Documentation</span><span style=color:#f92672>=</span><span style=color:#e6db74>https://k3s.io</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>After</span><span style=color:#f92672>=</span><span style=color:#e6db74>network-online.target</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Wants</span><span style=color:#f92672>=</span><span style=color:#e6db74>network-online.target</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Service]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#e6db74>notify</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>EnvironmentFile</span><span style=color:#f92672>=</span><span style=color:#e6db74>-/etc/default/%N</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>EnvironmentFile</span><span style=color:#f92672>=</span><span style=color:#e6db74>-/etc/sysconfig/%N</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>EnvironmentFile</span><span style=color:#f92672>=</span><span style=color:#e6db74>-/etc/systemd/system/k3s.service.env</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExecStartPre</span><span style=color:#f92672>=</span><span style=color:#e6db74>/bin/sh -xc &#39;! /usr/bin/systemctl is-enabled --quiet nm-cloud-setup.service&#39;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExecStart</span><span style=color:#f92672>=</span><span style=color:#e6db74>/usr/local/bin/k3s server</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>KillMode</span><span style=color:#f92672>=</span><span style=color:#e6db74>process</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Delegate</span><span style=color:#f92672>=</span><span style=color:#e6db74>yes</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Having non-zero Limit*s causes performance problems due to accounting overhead</span>
</span></span><span style=display:flex><span><span style=color:#75715e># in the kernel. We recommend using cgroups to do container-local accounting.</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>LimitNOFILE</span><span style=color:#f92672>=</span><span style=color:#e6db74>1048576</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>LimitNPROC</span><span style=color:#f92672>=</span><span style=color:#e6db74>infinity</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>LimitCORE</span><span style=color:#f92672>=</span><span style=color:#e6db74>infinity</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TasksMax</span><span style=color:#f92672>=</span><span style=color:#e6db74>infinity</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TimeoutStartSec</span><span style=color:#f92672>=</span><span style=color:#e6db74>0</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Restart</span><span style=color:#f92672>=</span><span style=color:#e6db74>always</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>RestartSec</span><span style=color:#f92672>=</span><span style=color:#e6db74>5s</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Install]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>WantedBy</span><span style=color:#f92672>=</span><span style=color:#e6db74>multi-user.target</span>
</span></span></code></pre></div><p>终止刚才运行的k3s进程，然后执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># systemctl enable --now k3s.server</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># systemctl status k3s</span>
</span></span><span style=display:flex><span>● k3s.service - Lightweight Kubernetes
</span></span><span style=display:flex><span>     Loaded: loaded <span style=color:#f92672>(</span>/etc/systemd/system/k3s.service; enabled; vendor preset: disabled<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>     Active: active <span style=color:#f92672>(</span>running<span style=color:#f92672>)</span> since Fri 2022-07-22 03:31:21 CST; 18h ago
</span></span><span style=display:flex><span>       Docs: https://k3s.io
</span></span><span style=display:flex><span>    Process: <span style=color:#ae81ff>1121</span> ExecStartPre<span style=color:#f92672>=</span>/bin/sh -xc ! /usr/bin/systemctl is-enabled --quiet nm-cloud-setup.service <span style=color:#f92672>(</span>code<span style=color:#f92672>=</span>exited, status<span style=color:#f92672>=</span>0/SUCCESS<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   Main PID: <span style=color:#ae81ff>1129</span> <span style=color:#f92672>(</span>k3s-server<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      Tasks: <span style=color:#ae81ff>120</span>
</span></span><span style=display:flex><span>     CGroup: /system.slice/k3s.service
</span></span><span style=display:flex><span>     ...
</span></span></code></pre></div><p>这是后k3s进程将以服务的形式运行在后台了。</p><p>执行完上述步骤后，k3s将会生产集群的管理员 kubeconfig 文件 - <em>/etc/rancher/k3s/k3s.yaml</em>，可将该文件拷贝的本地环境，修改 server 内容</p><p><del>server: https://127.0.0.1:6443</del>
server: https://192.168.0.150:6443</p><p>这样就可以在本地主机上使用 kubectl 访问集群了。</p><p>接下来，我们将在其他Server节点上启动k3s，并作为管理节点加入集群，首先在第一个节点 <strong>homek3s-server1</strong> 上获取到集群的Token</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># cat /var/lib/rancher/k3s/server/node-token </span>
</span></span><span style=display:flex><span>K1087c3ff53c94a3c3b20475e84602f1e6d46f1b3903f2979f144800990897b06ac::server:fb8e7aa7ba23d7652942b09cb440ba24
</span></span></code></pre></div><p>SSH登陆其他Server节点（<code>homek3s-server2</code> 和 <code>homek3s-server3</code>），执行如下步骤</p><ol><li><p>下载相同版本的 k3s 二进制文件到 <em>/usr/local/bin/k3s</em></p></li><li><p>执行如下命令加入集群</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># k3s server --server=https://192.168.0.150:6443 --token=${NODE_TOKEN}</span>
</span></span></code></pre></div><p>其中 ${NODE_TOKEN} 是上面从第一个节点获取的 Token 内容。</p><ol start=3><li>如第一个节点一样，配置 <em>etc/systemd/system/k3s.service</em>，将k3s进程启动以服务方式启动。</li></ol><p>完成上述步骤后，通过 kubectl 查看节点</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k get no
</span></span><span style=display:flex><span>NAME              STATUS   ROLES                       AGE   VERSION
</span></span><span style=display:flex><span>homek3s-server1   Ready    control-plane,etcd,master   28h   v1.24.3+k3s1
</span></span><span style=display:flex><span>homek3s-server2   Ready    control-plane,etcd,master   27h   v1.24.3+k3s1
</span></span><span style=display:flex><span>homek3s-server3   Ready    control-plane,etcd,master   27h   v1.24.3+k3s1
</span></span></code></pre></div><h2 id=启动agent节点>启动Agent节点</h2><p>在启动完3个管理节点（Server）的集群之后，我接下来继续添加工作节点（Agent）到集群中，登陆到3个Agent节点之下如下步骤（3个节点上的操作相同）</p><ol><li><p>下载相同版本的 k3s 二进制文件到 <em>/usr/local/bin/k3s</em> （方法与Server节点上一样）</p></li><li><p>执行如下命令，以工作节点加入集群</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># k3s agent --server=https://192.168.0.150:6443 --token=${NODE_TOKEN}</span>
</span></span></code></pre></div><p>${NODE_TOKEN} 是上面获取的节点Token值。</p><p>执行成功之后，也需要将 k3s 的 agent 进程以服务方式启动，这里与Server节点有些不同，创建文件 <em>/etc/systemd/system/k3s-agent.service</em>，内容如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-service data-lang=service><span style=display:flex><span><span style=color:#66d9ef>[Unit]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Description</span><span style=color:#f92672>=</span><span style=color:#e6db74>Lightweight Kubernetes</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Documentation</span><span style=color:#f92672>=</span><span style=color:#e6db74>https://k3s.io</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>After</span><span style=color:#f92672>=</span><span style=color:#e6db74>network-online.target</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Wants</span><span style=color:#f92672>=</span><span style=color:#e6db74>network-online.target</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Service]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#e6db74>notify</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>EnvironmentFile</span><span style=color:#f92672>=</span><span style=color:#e6db74>-/etc/default/%N</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>EnvironmentFile</span><span style=color:#f92672>=</span><span style=color:#e6db74>-/etc/sysconfig/%N</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>EnvironmentFile</span><span style=color:#f92672>=</span><span style=color:#e6db74>-/etc/systemd/system/k3s-agent.service.env</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExecStartPre</span><span style=color:#f92672>=</span><span style=color:#e6db74>/bin/sh -xc &#39;! /usr/bin/systemctl is-enabled --quiet nm-cloud-setup.service&#39;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExecStart</span><span style=color:#f92672>=</span><span style=color:#e6db74>/usr/local/bin/k3s agent --server=${K3S_URL} --token=${K3S_TOKEN}</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>KillMode</span><span style=color:#f92672>=</span><span style=color:#e6db74>process</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Delegate</span><span style=color:#f92672>=</span><span style=color:#e6db74>yes</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Having non-zero Limit*s causes performance problems due to accounting overhead</span>
</span></span><span style=display:flex><span><span style=color:#75715e># in the kernel. We recommend using cgroups to do container-local accounting.</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>LimitNOFILE</span><span style=color:#f92672>=</span><span style=color:#e6db74>1048576</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>LimitNPROC</span><span style=color:#f92672>=</span><span style=color:#e6db74>infinity</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>LimitCORE</span><span style=color:#f92672>=</span><span style=color:#e6db74>infinity</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TasksMax</span><span style=color:#f92672>=</span><span style=color:#e6db74>infinity</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TimeoutStartSec</span><span style=color:#f92672>=</span><span style=color:#e6db74>0</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Restart</span><span style=color:#f92672>=</span><span style=color:#e6db74>always</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>RestartSec</span><span style=color:#f92672>=</span><span style=color:#e6db74>5s</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Install]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>WantedBy</span><span style=color:#f92672>=</span><span style=color:#e6db74>multi-user.target</span>
</span></span></code></pre></div><p>然后再创建文件 <em>/etc/systemd/system/k3s-agent.service.env</em>，内容如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-env data-lang=env><span style=display:flex><span>K3S_URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://192.168.0.150:6443&#34;</span>
</span></span><span style=display:flex><span>K3S_TOKEN<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;K1087c3ff58c94a3c3b20475e84602f8e6d46f1b3903f2979f144800990897b06ac::server:fb8e7aa7ba23d7652942b09cb440ba24&#34;</span>
</span></span></code></pre></div><p>注意，将以上的 K3S_TOKEN 替换成你的值。<br>然后执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># sysetmctl enable --now k3s-agent.service</span>
</span></span></code></pre></div><p>3个Agent节点都启动完成之后，使用 kubectl 查看节点</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k get no
</span></span><span style=display:flex><span>NAME              STATUS   ROLES                       AGE   VERSION
</span></span><span style=display:flex><span>homek3s-agent1    Ready    &lt;none&gt;                      27h   v1.24.3+k3s1
</span></span><span style=display:flex><span>homek3s-agent2    Ready    &lt;none&gt;                      26h   v1.24.3+k3s1
</span></span><span style=display:flex><span>homek3s-agent3    Ready    &lt;none&gt;                      26h   v1.24.3+k3s1
</span></span><span style=display:flex><span>homek3s-server1   Ready    control-plane,etcd,master   28h   v1.24.3+k3s1
</span></span><span style=display:flex><span>homek3s-server2   Ready    control-plane,etcd,master   27h   v1.24.3+k3s1
</span></span><span style=display:flex><span>homek3s-server3   Ready    control-plane,etcd,master   27h   v1.24.3+k3s1
</span></span></code></pre></div><p>可以看到，我们以及通过K3S部署了一个3+3的高可用Kubernetes集群。</p><p><img src=../images/k3s-lens.png alt=k3s-lens></p><h2 id=部署应用>部署应用</h2><p>成功启动一个K3S集群，除了Kubernetes必要的组件之外，还自动为集群部署以下组件</p><ul><li>Flennel作为CNI插件</li><li>rancher-local-path 作为默认的存储类插件</li><li><a href=https://traefik.io target=_blank rel=noopener>Traefik</a> 作为 Ingress 控制器</li><li><a href=https://github.com/k3s-io/klipper-lb target=_blank rel=noopener>kipper Load Balancer</a> 作为服务的负载均均衡控制器</li></ul><p>Traefik的Load Balancer类型的服务就直接通过每个节点的 80 和 443 端口暴露了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k get svc -n kube-system
</span></span><span style=display:flex><span>traefik          LoadBalancer   10.43.66.163   192.168.0.150,192.168.0.151,192.168.0.152,192.168.0.154,192.168.0.155,192.168.0.156   80:30833/TCP,443:32747/TCP   28h
</span></span></code></pre></div><p>因此，我们可以直接创建应用，并通过Ingress向外暴露服务，这里我们创建一个简单的Web服务，也就是 <a href=https://hub.docker.com/r/docker/getting-started target=_blank rel=noopener>Docker的教程</a>，创建如下资源文件 <code>docker-tour.yaml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>com.docker.project</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>com.docker.project</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>strategy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>Recreate</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>com.docker.project</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>image</span>: <span style=color:#ae81ff>docker/getting-started</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>name</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>resources</span>: {}
</span></span><span style=display:flex><span>      <span style=color:#f92672>restartPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>80</span>-<span style=color:#ae81ff>tcp</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>com.docker.project</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>ClusterIP</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>networking.k8s.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Ingress</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>com.docker.project</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#75715e>#  ingressClassName: contour</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>host</span>: <span style=color:#e6db74>&#34;tour.homek3s.lan&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>pathType</span>: <span style=color:#ae81ff>Prefix</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>path</span>: <span style=color:#e6db74>&#34;/&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>backend</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>tutorial</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>port</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>number</span>: <span style=color:#ae81ff>80</span>
</span></span></code></pre></div><p>然后执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ kubectl apply -f docker-tour.yaml
</span></span></code></pre></div><p>在你的内部DNS服务器，或者 <code>/etc/hosts</code> 中配置域名解析，将 <code>tour.homek3s.lan</code> 解析到任何一个节点的IP地址，如</p><pre tabindex=0><code class=language-hosts data-lang=hosts>192.168.0.150   tour.homek3s.lan
</code></pre><p>通过浏览器访问 <a href=https://tour.homek3s.lan/ target=_blank rel=noopener>https://tour.homek3s.lan/</a> ，将打开部署的应用。</p><p><img src=https://pics.mengz.dev/upload/2023/05/07/20230507113655-27096950.png alt=k3s-tour-access></p><h2 id=总结>总结</h2><p>这里演示了如果通过K3S部署一个高可用的Kubernetes集群，使用k3s内置etcd的方式作为入门，k3s还支持使用外部的数据存储以及其他更多的部署选项，可参考<a href=https://rancher.com/docs/k3s/latest/en/ target=_blank rel=noopener>官方文档</a>。K3s作为一个轻量级的kubernetes版本，以了单一的二进制文件 - k3s进行分发，可以快速部署开发测试，以及边缘生产级别的集群。<br>后期将会继续探索另一款开源的轻量级Kubeernets版本 - <a href=https://k0sproject.io target=_blank rel=noopener>K0S</a>。</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=%2fzh%2fposts%2fk8s%2flightweight-k3s%2f" target=_blank><i class="fab fa-facebook"></i></a>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=%2fzh%2fposts%2fk8s%2flightweight-k3s%2f&text=%e8%bd%bb%e9%87%8f%e7%ba%a7Kubernetes%e9%9b%86%e7%be%a4-K3S&via=Mengz%27s%20Space%20..." target=_blank><i class="fab fa-twitter"></i></a>
<a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=%2fzh%2fposts%2fk8s%2flightweight-k3s%2f&title=%e8%bd%bb%e9%87%8f%e7%ba%a7Kubernetes%e9%9b%86%e7%be%a4-K3S" target=_blank><i class="fab fa-linkedin"></i></a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/zh/posts/k8s/kubectl-plugins/ title=扩展你的KUBECTL功能 class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>扩展你的KUBECTL功能</div></a></div><div class="col-md-6 next-article"><a href=/zh/posts/linux/bumlebee-nvidia/ title=BUMBLEBEE禁用NVIDIA显卡 class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>BUMBLEBEE禁用NVIDIA显卡</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#k3s架构>k3S架构</a></li><li><a href=#准备虚拟机节点>准备虚拟机节点</a></li><li><a href=#启动server节点>启动Server节点</a></li><li><a href=#启动agent节点>启动Agent节点</a></li><li><a href=#部署应用>部署应用</a></li><li><a href=#总结>总结</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/zh/#about>关于</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#skills>技能</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#experiences>工作经历</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#education>教育</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#recent-posts>近期文章</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#accomplishments>技能学习</a></li><li class=nav-item><a class=smooth-scroll href=https://live.mengz.dev/>LiveTerm</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:mengz.you@outlook.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>mengz.you@outlook.com</span></a></li><li><a href=https://github.com/mengzyou target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>mengzyou</span></a></li><li><a href=https://www.linkedin.com/in/mengzyou target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>You Mengzhe</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2023 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.db0199346ceeeb49917f3fd7dbfb4671e56b6f1c743dd2bf80e19618c343bef7.js integrity="sha256-2wGZNGzu60mRfz/X2/tGceVrbxx0PdK/gOGWGMNDvvc=" defer></script>
<script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script>
<script>kofiWidgetOverlay.draw("mengz",{type:"floating-chat","floating-chat.donateButton.text":"Buy me a book","floating-chat.donateButton.text-color":"#f9fafc","floating-chat.donateButton.background-color":"#248aaa"})</script></body></html>