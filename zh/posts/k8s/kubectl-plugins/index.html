<!doctype html><html lang=zh><head><title>扩展你的KUBECTL功能</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/application.fb9df7e952c9dccf496d00faec07de633aae460f909bbba4b5e0ad22f5887d73.css integrity="sha256-+5336VLJ3M9JbQD67AfeYzquRg+Qm7ukteCtIvWIfXM="><link rel=icon type=image/png href=/images/site/favicon_hu3d2f89ed4395f8e4a11f46415bebb510_10034_42x0_resize_box_3.png><meta property="og:title" content="扩展你的KUBECTL功能"><meta property="og:description" content="介绍kubectl的插件来增强kubectl命令行工具的功能"><meta property="og:type" content="article"><meta property="og:url" content="/zh/posts/k8s/kubectl-plugins/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-04T15:37:12+08:00"><meta property="article:modified_time" content="2022-07-04T15:37:12+08:00"><meta name=description content="介绍kubectl的插件来增强kubectl命令行工具的功能"><script src=https://cdn.counter.dev/script.js data-id=2905461c-37df-49f9-a4ca-0ea1ba64543a data-utcoffset=1></script></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/zh/><img src=/images/site/main-logo_hu69a4da50b288ac7c5f97b1e1012a418e_8650_42x0_resize_box_3.png alt=Logo>
Mengz's Space ...</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu69a4da50b288ac7c5f97b1e1012a418e_8650_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu3d2f89ed4395f8e4a11f46415bebb510_10034_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/zh/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/zh/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/zh/posts/k8s/>Kubernetes</a><ul class=active><li><a href=/zh/posts/k8s/health-checks/ title=K8S健康检查最佳实践>K8S健康检查最佳实践</a></li><li><a class=active href=/zh/posts/k8s/kubectl-plugins/ title=扩展你的KUBECTL功能>扩展你的KUBECTL功能</a></li><li><a href=/zh/posts/k8s/lightweight-k3s/ title=轻量级Kubernetes集群-K3S>轻量级Kubernetes集群-K3S</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/linux/>LINUX</a><ul><li><a href=/zh/posts/linux/bumlebee-nvidia/ title=BUMBLEBEE禁用NVIDIA显卡>BUMBLEBEE禁用NVIDIA显卡</a></li><li><a href=/zh/posts/linux/systemd-hostnamectl/ title=HOSTNAMECTL管理主机名>HOSTNAMECTL管理主机名</a></li><li><a href=/zh/posts/linux/make-undeletable/ title=LINUX上创建不可删除文件>LINUX上创建不可删除文件</a></li><li><a href=/zh/posts/linux/network-packets/ title=LINUX上统计网络接口数据包>LINUX上统计网络接口数据包</a></li><li><a href=/zh/posts/linux/opensuse-zypper/ title=OPENSUSE上的ZYPPER包管理器>OPENSUSE上的ZYPPER包管理器</a></li><li><a href=/zh/posts/linux/opensuse-cronjob/ title=OPENSUSE上的定时任务>OPENSUSE上的定时任务</a></li><li><a href=/zh/posts/linux/systemd-systemctl/ title=SYSTEMCTL管理系统服务>SYSTEMCTL管理系统服务</a></li><li><a href=/zh/posts/linux/systemd-timer/ title=SYSTEMD定时服务>SYSTEMD定时服务</a></li><li><a href=/zh/posts/linux/opensuse-upgrade/ title="升级OPENSUSE LEAP">升级OPENSUSE LEAP</a></li><li><a href=/zh/posts/linux/wireguard-vpn/ title=在LINUX上配置WIREGUARD>在LINUX上配置WIREGUARD</a></li><li><a href=/zh/posts/linux/ubuntu-old-kernel/ title=在UBUNTU上删除旧的内核>在UBUNTU上删除旧的内核</a></li><li><a href=/zh/posts/linux/what-hardware/ title=查看硬件信息>查看硬件信息</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/windows/>Windows</a><ul><li><a href=/zh/posts/windows/windows10-wsl2/ title=Windows10上安装WSL2>Windows10上安装WSL2</a></li><li><a href=/zh/posts/windows/windows10-virtio-image/ title=加载virtio驱动的Windows10安装镜像>加载virtio驱动的Windows10安装镜像</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/container-tech/>容器技术</a><ul><li><a href=/zh/posts/container-tech/docker-live-restore/ title="DOCKER LIVERESTORE特性">DOCKER LIVERESTORE特性</a></li><li><a href=/zh/posts/container-tech/docker-sbom/ title="DOCKER SBOM镜像物料清单">DOCKER SBOM镜像物料清单</a></li><li><a href=/zh/posts/container-tech/dockerfile-best/ title=DOCKERFILE构建最佳实践>DOCKERFILE构建最佳实践</a></li><li><a href=/zh/posts/container-tech/docker-intro/ title=DOCKER入门>DOCKER入门</a></li><li><a href=/zh/posts/container-tech/mariadb-docker/ title=DOCKER构建MariaDB>DOCKER构建MariaDB</a></li><li><a href=/zh/posts/container-tech/docker-container-app/ title=DOCKER构建容器化应用>DOCKER构建容器化应用</a></li><li><a href=/zh/posts/container-tech/docker-wechat/ title=DOCKER运行微信桌面客户端>DOCKER运行微信桌面客户端</a></li><li><a href=/zh/posts/container-tech/docker-desktop-windows/ title="WINDOWS上的DOCKER DESKTOP">WINDOWS上的DOCKER DESKTOP</a></li><li><a href=/zh/posts/container-tech/docker-compose-v2/ title="开始使用DOCKER COMPOSE V2">开始使用DOCKER COMPOSE V2</a></li><li><a href=/zh/posts/container-tech/smallest-web-container/ title=最小化静态WEB容器实践>最小化静态WEB容器实践</a></li><li><a href=/zh/posts/container-tech/docker-mqtt-broker/ title=本地环境运行MQTT容器>本地环境运行MQTT容器</a></li><li><a href=/zh/posts/container-tech/docker-context-remote/ title=管理远程DOCKER主机>管理远程DOCKER主机</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/devops/>开发运维</a><ul><li><a href=/zh/posts/devops/github-actions/ title="GITHUB ACTIONS工作流">GITHUB ACTIONS工作流</a></li><li><a href=/zh/posts/devops/gitlab-ci-docker/ title="GITLAB CI自动部署容器应用">GITLAB CI自动部署容器应用</a></li><li><a href=/zh/posts/devops/k3s-terraform-ansible/ title=IaC示例-TERRAFORM&amp;ANSIBLE创建K3S集群>IaC示例-TERRAFORM&amp;ANSIBLE创建K3S集群</a></li><li><a href=/zh/posts/devops/tf-rover/ title=TF执行计划可视化>TF执行计划可视化</a></li><li><a href=/zh/posts/devops/tf-aws-lightsail/ title="TF管理AWS LIGHTSAIL实例">TF管理AWS LIGHTSAIL实例</a></li><li><a href=/zh/posts/devops/single-application-cicd/ title=一体化CI/CD平台>一体化CI/CD平台</a></li><li><a href=/zh/posts/devops/open-gitops/ title="解读OPEN GITOPS 1.0">解读OPEN GITOPS 1.0</a></li><li><a href=/zh/posts/devops/tf-cloud/ title="迁移本地项目到TF CLOUD">迁移本地项目到TF CLOUD</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/opentool/>开源工具</a><ul><li><a href=/zh/posts/opentool/diun-intro/ title=DIUN-容器镜像更新通知>DIUN-容器镜像更新通知</a></li><li><a href=/zh/posts/opentool/rclone-sync/ title=RCLOUD与云存储同步>RCLOUD与云存储同步</a></li><li><a href=/zh/posts/opentool/find-files/ title=文件系统查找工具>文件系统查找工具</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/zh/posts/programming/>编程</a><ul><li><a href=/zh/posts/programming/cocktail-improve/ title=改良鸡尾酒排序算法>改良鸡尾酒排序算法</a></li><li><a href=/zh/posts/programming/shell-debug/ title=调试Shell脚本错误>调试Shell脚本错误</a></li></ul></li><li><a href=/zh/posts/markdown-sample/ title=Markdown示例>Markdown示例</a></li><li><a href=/zh/posts/shortcodes/ title=短代码示例>短代码示例</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/zh/posts/k8s/kubectl-plugins/krew-banner.webp)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/mengzyou_huc2c98b30dea57d312a21b09cfacc124e_6244_120x120_fit_q75_h2_box_2.webp alt="Author Image"><h5 class=author-name>You Mengzhe</h5><p>2022年7月4日星期一</p></div><div class=title><h1>扩展你的KUBECTL功能</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/zh/tags/kubernetes/ class="btn, btn-sm">kubernetes</a></li><li class=rounded><a href=/zh/tags/kubectl/ class="btn, btn-sm">kubectl</a></li></ul></div><div class=post-content id=post-content><p>随着 <a href=https://kubernetes.io target=_blank rel=noopener>Kubernetes</a> 成为主流的应用容器编排平台，其命令行客户端 <code>kubectl</code> 也成为了我们日常部署应用，维护集群最常用的工具。<br><code>kubectl</code> 自身提供了强大的内置自命令来满足我们对集群的操作，例如 <code>get</code> 获取集群内的资源对象，<code>proxy</code> 创建代理之类的，除了内置的这些自命令，<code>kubectl</code> 还提供了可扩展的能力，允许我们安装自己编写或者社区提供的插件来增强我们使用 <code>kubectl</code> 的生产力。</p><p>这里将给大家介绍如何在安装 <code>kubectl</code> 扩展插件，以及几款我在日常工作中常用到的社区提供的插件。</p><p>在安装和使用 <code>kubectl</code> 插件的之前，请确保以及安装和配置好 <code>kubectl</code> 命令行工具和 <code>git</code> 工具。</p><h2 id=krew>krew</h2><p>首先介绍的第一款扩展插件就是 <strong>krew</strong> - k8s特别兴趣小组开发的一款用于安装和管理 <code>kubectl</code> 扩展插件的插件。</p><p>代码： <a href=https://github.com/kubernetes-sigs/krew target=_blank rel=noopener>https://github.com/kubernetes-sigs/krew</a></p><p>安装 <strong>krew</strong> (在macOS/Linux上):</p><ol><li>在终端执行（Bash或者Zsh）执行</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>  set -x; cd <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>mktemp -d<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>  OS<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname | tr <span style=color:#e6db74>&#39;[:upper:]&#39;</span> <span style=color:#e6db74>&#39;[:lower:]&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>  ARCH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>uname -m | sed -e <span style=color:#e6db74>&#39;s/x86_64/amd64/&#39;</span> -e <span style=color:#e6db74>&#39;s/\(arm\)\(64\)\?.*/\1\2/&#39;</span> -e <span style=color:#e6db74>&#39;s/aarch64$/arm64/&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>  KREW<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;krew-</span><span style=color:#e6db74>${</span>OS<span style=color:#e6db74>}</span><span style=color:#e6db74>_</span><span style=color:#e6db74>${</span>ARCH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>  curl -fsSLO <span style=color:#e6db74>&#34;https://github.com/kubernetes-sigs/krew/releases/latest/download/</span><span style=color:#e6db74>${</span>KREW<span style=color:#e6db74>}</span><span style=color:#e6db74>.tar.gz&#34;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>  tar zxvf <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>KREW<span style=color:#e6db74>}</span><span style=color:#e6db74>.tar.gz&#34;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>  ./<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>KREW<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> install krew
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>
</span></span></code></pre></div><ol start=2><li>将 <em>$HOME/.krew/bin</em> 加入到 <strong>PATH</strong> 环境变量，更新你的 <em>.bashrc</em> 或者 <em>.zshrc</em> 文件，添加下面一行</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>KREW_ROOT<span style=color:#66d9ef>:-</span>$HOME/.brew<span style=color:#e6db74>}</span><span style=color:#e6db74>/bin:</span>$PATH<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>然后重启你的终端。</p><ol start=3><li>测试 <strong>krew</strong> 已经安装成功</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k krew version
</span></span><span style=display:flex><span>OPTION            VALUE
</span></span><span style=display:flex><span>GitTag            v0.4.3
</span></span><span style=display:flex><span>GitCommit         dbfefa5
</span></span><span style=display:flex><span>IndexURI          https://github.com/kubernetes-sigs/krew-index.git
</span></span><span style=display:flex><span>BasePath          /home/mengz/.krew
</span></span><span style=display:flex><span>IndexPath         /home/mengz/.krew/index/default
</span></span><span style=display:flex><span>InstallPath       /home/mengz/.krew/store
</span></span><span style=display:flex><span>BinPath           /home/mengz/.krew/bin
</span></span><span style=display:flex><span>DetectedPlatform  linux/amd64
</span></span></code></pre></div><ol start=4><li>（可选）设置 krew 别名</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>alias krew<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;kubectl-krew&#39;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;alias krew=&#39;kubectl-krew&#39;&#34;</span> &gt;&gt; ~/.alias
</span></span></code></pre></div><p>这样就安装完成了，<strong>krew</strong> 是 <code>kubectl</code> 插件管理器，而 <code>krew</code> 自己又是插件，所以之后可以使用 <code>krew</code> 来更新 <code>krew</code>。</p><p>在 Windows 上安装，请参考 <a href=https://krew.sigs.k8s.io/docs/user-guide/setup/install/ target=_blank rel=noopener>https://krew.sigs.k8s.io/docs/user-guide/setup/install/</a> 。</p><p>使用示例</p><ul><li>列出当前已安装的插件</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ krew list
</span></span><span style=display:flex><span>PLUGIN            VERSION
</span></span><span style=display:flex><span>krew              v0.4.3
</span></span></code></pre></div><ul><li>安装插件（下面介绍的其他插件将使用这个方式安装）</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ krew install <span style=color:#f92672>[</span>插件名<span style=color:#f92672>]</span>
</span></span></code></pre></div><ul><li>更新本地插件索引（查看是否有插件更新）</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ krew update
</span></span><span style=display:flex><span>Updated the local copy of plugin index.
</span></span><span style=display:flex><span>  New plugins available:
</span></span><span style=display:flex><span>    * liqo
</span></span><span style=display:flex><span>    * switch-config
</span></span><span style=display:flex><span>  Upgrades available <span style=color:#66d9ef>for</span> installed plugins:
</span></span><span style=display:flex><span>    * open-svc v2.5.2 -&gt; v2.5.3
</span></span><span style=display:flex><span>    * rbac-tool v1.7.1 -&gt; v1.8.0
</span></span><span style=display:flex><span>    * rolesum v1.5.1 -&gt; v1.5.5
</span></span></code></pre></div><ul><li>升级插件</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ krew upgrade open-svc
</span></span><span style=display:flex><span>Updated the local copy of plugin index.
</span></span><span style=display:flex><span>Upgrading plugin: open-svc
</span></span></code></pre></div><ul><li>删除插件</li></ul><pre tabindex=0><code>❯ krew uninstall [插件名]
</code></pre><p><a href=https://krew.sigs.k8s.io/plugins/ target=_blank rel=noopener>krew-index</a> 里维护了上百款可通过 krew 直接安装的插件。接下来将介绍其他几款我日常使用的 <code>kubectl</code> 插件。</p><h2 id=example>example</h2><p>代码： <a href=https://github.com/seredot/kubectl-example target=_blank rel=noopener>https://github.com/seredot/kubectl-example</a></p><p>安装 <code>krew install example</code></p><p><code>example</code> 插件可用于快速生成k8s资源对象的yaml文件示例，例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k example deploy
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>apiVersion: apps/v1
</span></span><span style=display:flex><span>kind: Deployment
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: nginx-deployment
</span></span><span style=display:flex><span>  labels:
</span></span><span style=display:flex><span>    app: nginx
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  replicas: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>  selector:
</span></span><span style=display:flex><span>    matchLabels:
</span></span><span style=display:flex><span>      app: nginx
</span></span><span style=display:flex><span>  template:
</span></span><span style=display:flex><span>    metadata:
</span></span><span style=display:flex><span>      labels:
</span></span><span style=display:flex><span>        app: nginx
</span></span><span style=display:flex><span>    spec:
</span></span><span style=display:flex><span>      containers:
</span></span><span style=display:flex><span>        - name: nginx
</span></span><span style=display:flex><span>          image: nginx:1.14.2
</span></span><span style=display:flex><span>          ports:
</span></span><span style=display:flex><span>            - containerPort: <span style=color:#ae81ff>80</span>
</span></span></code></pre></div><p>当我们想临时通过资源声明文件不熟应用的时候，可以使用该插件来生成模板。</p><h2 id=fleet>fleet</h2><p>代码： <a href=https://github.com/kubectl-plus/kcf target=_blank rel=noopener>https://github.com/kubectl-plus/kcf</a></p><p>安装： <code>krew install fleet</code></p><p><code>fleet</code> 插件可快速查看当前配置的集群的概览</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k fleet
</span></span><span style=display:flex><span>CLUSTER                                    VERSION         NODES NAMESPACES PROVIDER   API
</span></span><span style=display:flex><span>homek8sc1                                  v1.23.8         3/3   <span style=color:#ae81ff>4</span>          ?          https://k8sc1.mengz.lan:6443
</span></span><span style=display:flex><span>api-sandbox-x8i5-p1-openshiftapps-com:6443 v1.23.5+9ce5071 ?     ?          ?          https://api.sandbox.x8i5.p1.openshiftapps.com:6443
</span></span><span style=display:flex><span>minikube                                   v1.22.3         1/1   <span style=color:#ae81ff>4</span>          minikube   https://192.168.64.3:8443
</span></span></code></pre></div><h2 id=get-all>get-all</h2><p>代码： <a href=https://github.com/corneliusweig/ketall target=_blank rel=noopener>https://github.com/corneliusweig/ketall</a></p><p>安装： <code>krew install get-all</code></p><p><code>get-all</code> 插件获取集群（或者某一个名字空间）的所有资源对象</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k get-all -n kube-system
</span></span><span style=display:flex><span>NAME                                                                                     NAMESPACE    AGE
</span></span><span style=display:flex><span>configmap/calico-config                                                                  kube-system  13d  
</span></span><span style=display:flex><span>configmap/coredns                                                                        kube-system  13d  
</span></span><span style=display:flex><span>configmap/extension-apiserver-authentication                                             kube-system  13d  
</span></span><span style=display:flex><span>configmap/kube-proxy                                                                     kube-system  13d  
</span></span><span style=display:flex><span>configmap/kube-root-ca.crt                                                               kube-system  13d  
</span></span><span style=display:flex><span>configmap/kubeadm-config                                                                 kube-system  13d  
</span></span><span style=display:flex><span>configmap/kubelet-config-1.23                                                            kube-system  13d  
</span></span><span style=display:flex><span>endpoints/kube-dns                                                                       kube-system  13d
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h2 id=htpasswd>htpasswd</h2><p>代码： <a href=https://github.com/shibumi/kubectl-htpasswd target=_blank rel=noopener>https://github.com/shibumi/kubectl-htpasswd</a></p><p>安装： <code>krew install htpasswd</code></p><p><code>htpasswd</code> 是 nginx-ingress 兼容的基础认证密码生成器</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k htpasswd create aaa-basic-auth user1<span style=color:#f92672>=</span>user1password user2<span style=color:#f92672>=</span>user2password -o yaml --dry-run
</span></span><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>data:
</span></span><span style=display:flex><span>  auth: dXNlcjE6JDJhJDEwJDVNeEJGT3lEUEJYT0xkUldlblNWME91RGtZTzFQOElJNXJuRnh5blpUdC55L2FUUUNDYzJ1CnVzZXIyOiQyYSQxMCRVbFdHOG5NTU4zRGVpOC5GMmVRM3EuYWhxTENYZGtLYUJ1cXZzT3lEOGl0ODJRdU4zV1c1dQ<span style=color:#f92672>==</span>
</span></span><span style=display:flex><span>kind: Secret
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  creationTimestamp: null
</span></span><span style=display:flex><span>  name: aaa-basic-auth
</span></span><span style=display:flex><span>  namespace: default
</span></span><span style=display:flex><span>type: Opaque
</span></span></code></pre></div><p>该插件在为服务创建基础认证的 Ingress 很方便。</p><h2 id=images>images</h2><p>代码： <a href=https://github.com/chenjiandongx/kubectl-images target=_blank rel=noopener>https://github.com/chenjiandongx/kubectl-images</a></p><p>安装： <code>krew install images</code></p><p><code>images</code> 现实名字空间中使用的容器镜像信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k images
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Summary<span style=color:#f92672>]</span>: <span style=color:#ae81ff>1</span> namespaces, <span style=color:#ae81ff>2</span> pods, <span style=color:#ae81ff>2</span> containers and <span style=color:#ae81ff>1</span> different images
</span></span><span style=display:flex><span>+------------------------+---------------+-------------------+
</span></span><span style=display:flex><span>|        PodName         | ContainerName |  ContainerImage   |
</span></span><span style=display:flex><span>+------------------------+---------------+-------------------+
</span></span><span style=display:flex><span>| webapp-98f7444c5-8772w | nginx         | nginx:1.21-alpine |
</span></span><span style=display:flex><span>+------------------------+               +                   +
</span></span><span style=display:flex><span>| webapp-98f7444c5-vsxr9 |               |                   |
</span></span><span style=display:flex><span>+------------------------+---------------+-------------------+
</span></span></code></pre></div><h2 id=ktop>ktop</h2><p>代码： <a href=https://github.com/vladimirvivien/ktop target=_blank rel=noopener>https://github.com/vladimirvivien/ktop</a></p><p>安装： <code>krew install ktop</code></p><p><code>ktop</code> 插件是以类似 Linux Top 工具的方式来插件k8s集群的负载情况</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ k ktop
</span></span><span style=display:flex><span>┌ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
</span></span><span style=display:flex><span>│   API server: https://k8sc1.mengz.lan:6443 Version: v1.23.8 context: admin@homek8sc1 User: kubernetes-admin namespace: <span style=color:#f92672>(</span>all<span style=color:#f92672>)</span>  metrics: not connected                            v0.3.0  
</span></span><span style=display:flex><span>└ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
</span></span><span style=display:flex><span>╔ 🌡 Cluster Summary ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═
</span></span><span style=display:flex><span>║ ptime: 13d   Nodes: <span style=color:#ae81ff>3</span>   Namespaces: <span style=color:#ae81ff>4</span>    Pods: 15/15 <span style=color:#f92672>(</span><span style=color:#ae81ff>20</span> imgs<span style=color:#f92672>)</span>     Deployments: 5/5    Sets: replicas 5, daemons 6, stateful <span style=color:#ae81ff>0</span>      Jobs: <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>cron: 0<span style=color:#f92672>)</span>    PVs: <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0Gi<span style=color:#f92672>)</span> PVCs: <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0Gi<span style=color:#f92672>)</span>     
</span></span><span style=display:flex><span>║ PU: <span style=color:#f92672>[||||||||||</span>|                             <span style=color:#f92672>]</span> 1600m/6000m <span style=color:#f92672>(</span>26.7% requested<span style=color:#f92672>)</span>               Memory: <span style=color:#f92672>[||</span>                                      <span style=color:#f92672>]</span> 1Gi/11Gi <span style=color:#f92672>(</span>2.5% requested<span style=color:#f92672>)</span>                 
</span></span><span style=display:flex><span>╚ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═ ═
</span></span><span style=display:flex><span>┌ 🏭 Nodes <span style=color:#f92672>(</span>3<span style=color:#f92672>)</span> ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─  
</span></span><span style=display:flex><span>│   NAME                STATUS   AGE   VERSION   INT/EXT IPs            OS/ARC                      PODS/IMGs    DISK    CPU                               MEM                            
</span></span><span style=display:flex><span>│   homek8sc1-control   Ready    13d   v1.23.8   192.168.0.140/&lt;none&gt;   Ubuntu 20.04.4 LTS/amd64    9/10         16Gi    <span style=color:#f92672>[||||||</span>    <span style=color:#f92672>]</span> 1100m/2000m <span style=color:#f92672>(</span>55%<span style=color:#f92672>)</span>    <span style=color:#f92672>[||</span>        <span style=color:#f92672>]</span> 1Gi/2Gi <span style=color:#f92672>(</span>13%<span style=color:#f92672>)</span>     
</span></span><span style=display:flex><span>│   homek8sc1-worker1   Ready    13d   v1.23.8   192.168.0.141/&lt;none&gt;   Ubuntu 20.04.4 LTS/amd64    3/5          16Gi    <span style=color:#f92672>[||</span>        <span style=color:#f92672>]</span> 250m/2000m <span style=color:#f92672>(</span>12%<span style=color:#f92672>)</span>     <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0Gi/5Gi <span style=color:#f92672>(</span>0%<span style=color:#f92672>)</span>      
</span></span><span style=display:flex><span>│   homek8sc1-worker2   Ready    13d   v1.23.8   192.168.0.142/&lt;none&gt;   Ubuntu 20.04.4 LTS/amd64    3/5          16Gi    <span style=color:#f92672>[||</span>        <span style=color:#f92672>]</span> 250m/2000m <span style=color:#f92672>(</span>12%<span style=color:#f92672>)</span>     <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0Gi/5Gi <span style=color:#f92672>(</span>0%<span style=color:#f92672>)</span>      
</span></span><span style=display:flex><span>│                                                                                                                                                                                         
</span></span><span style=display:flex><span>└ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
</span></span><span style=display:flex><span>┌ 📦 Pods <span style=color:#f92672>(</span>15<span style=color:#f92672>)</span> ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
</span></span><span style=display:flex><span>│ AMESPACE    POD                                        READY   STATUS    RESTARTS   AGE   VOLS   IP              NODE                CPU                       MEMORY                   
</span></span><span style=display:flex><span>│ ube-system  kube-controller-manager-homek8sc1-control  1/1     Running   <span style=color:#ae81ff>1</span>          13d   8/8    192.168.0.140   homek8sc1-control   <span style=color:#f92672>[</span>|         <span style=color:#f92672>]</span> 200m 10.0%   <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0Gi 0.0%    
</span></span><span style=display:flex><span>│ ube-system  kube-proxy-4c9nq                           1/1     Running   <span style=color:#ae81ff>2</span>          13d   4/4    192.168.0.141   homek8sc1-worker1   <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0m 0.0%      <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0Gi 0.0%    
</span></span><span style=display:flex><span>│ ube-system  kube-proxy-4whcn                           1/1     Running   <span style=color:#ae81ff>1</span>          13d   4/4    192.168.0.140   homek8sc1-control   <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0m 0.0%      <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0Gi 0.0%    
</span></span><span style=display:flex><span>│ ube-system  kube-proxy-bz8lt                           1/1     Running   <span style=color:#ae81ff>3</span>          13d   4/4    192.168.0.142   homek8sc1-worker2   <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0m 0.0%      <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0Gi 0.0%    
</span></span><span style=display:flex><span>│ ube-system  kube-scheduler-homek8sc1-control           1/1     Running   <span style=color:#ae81ff>1</span>          13d   1/1    192.168.0.140   homek8sc1-control   <span style=color:#f92672>[</span>|         <span style=color:#f92672>]</span> 100m 5.0%    <span style=color:#f92672>[</span>          <span style=color:#f92672>]</span> 0Gi 0.0%    
</span></span><span style=display:flex><span>└ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
</span></span></code></pre></div><h2 id=总结>总结</h2><p><a href=https://krew.sigs.k8s.io/plugins/ target=_blank rel=noopener>krew-index</a> 里包含了大量功能强大的扩展插件，涵盖了 RBAC 管理，资源管理等功能，这里没法意义列出。不过有了 <code>krew</code> ，我们可以很方便的安装需要的扩展，以在日常工作中提高我们管理k8s集群的的生产力。</p><blockquote><p>参考</p><ul><li><a href=https://kubernetes.io/docs/tasks/extend-kubectl/kubectl-plugins/ target=_blank rel=noopener>https://kubernetes.io/docs/tasks/extend-kubectl/kubectl-plugins/</a></li><li><a href=https://krew.sigs.k8s.io/docs/user-guide/quickstart/ target=_blank rel=noopener>https://krew.sigs.k8s.io/docs/user-guide/quickstart/</a></li></ul></blockquote></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=%2fzh%2fposts%2fk8s%2fkubectl-plugins%2f" target=_blank><i class="fab fa-facebook"></i></a>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=%2fzh%2fposts%2fk8s%2fkubectl-plugins%2f&text=%e6%89%a9%e5%b1%95%e4%bd%a0%e7%9a%84KUBECTL%e5%8a%9f%e8%83%bd&via=Mengz%27s%20Space%20..." target=_blank><i class="fab fa-twitter"></i></a>
<a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=%2fzh%2fposts%2fk8s%2fkubectl-plugins%2f&title=%e6%89%a9%e5%b1%95%e4%bd%a0%e7%9a%84KUBECTL%e5%8a%9f%e8%83%bd" target=_blank><i class="fab fa-linkedin"></i></a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/zh/posts/k8s/health-checks/ title=K8S健康检查最佳实践 class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>K8S健康检查最佳实践</div></a></div><div class="col-md-6 next-article"><a href=/zh/posts/k8s/lightweight-k3s/ title=轻量级Kubernetes集群-K3S class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>轻量级Kubernetes集群-K3S</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#krew>krew</a></li><li><a href=#example>example</a></li><li><a href=#fleet>fleet</a></li><li><a href=#get-all>get-all</a></li><li><a href=#htpasswd>htpasswd</a></li><li><a href=#images>images</a></li><li><a href=#ktop>ktop</a></li><li><a href=#总结>总结</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/zh/#about>关于</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#skills>技能</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#experiences>工作经历</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#education>教育</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#recent-posts>近期文章</a></li><li class=nav-item><a class=smooth-scroll href=/zh/#accomplishments>技能学习</a></li><li class=nav-item><a class=smooth-scroll href=https://live.mengz.dev/>LiveTerm</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:mengz.you@outlook.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>mengz.you@outlook.com</span></a></li><li><a href=https://github.com/mengzyou target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>mengzyou</span></a></li><li><a href=https://www.linkedin.com/in/mengzyou target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>You Mengzhe</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2023 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.3f98eac98ee0e5efd906fd54a896210d7d275efa5f73c9f8712612a554846688.js integrity="sha256-P5jqyY7g5e/ZBv1UqJYhDX0nXvpfc8n4cSYSpVSEZog=" defer></script>
<script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script>
<script>kofiWidgetOverlay.draw("mengz",{type:"floating-chat","floating-chat.donateButton.text":"Buy me a book","floating-chat.donateButton.text-color":"#f9fafc","floating-chat.donateButton.background-color":"#248aaa"})</script></body></html>